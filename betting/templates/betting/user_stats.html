{% extends 'betting/base.html' %}

{% block title %}Статистика - Система ставок{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header">
        <h1 class="card-title">Ваша статистика</h1>
    </div>

    <div class="stats-overview">
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value">{{ total_bets }}</div>
                <div class="stat-label">Всего ставок</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">{{ active_bets }}</div>
                <div class="stat-label">Активные ставки</div>
            </div>
            <div class="stat-card">
                <div class="stat-value {% if net_profit >= 0 %}stat-positive{% else %}stat-negative{% endif %}">
                    {{ net_profit }} ₽
                </div>
                <div class="stat-label">Чистая прибыль</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">{{ user_profile.balance }} ₽</div>
                <div class="stat-label">Текущий баланс</div>
            </div>
        </div>
    </div>

    <div class="detailed-stats grid grid-2">
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">Результаты ставок</h2>
            </div>
            <div class="stats-list">
                <div class="stat-item">
                    <span class="stat-label">Выиграно ставок:</span>
                    <span class="stat-value">{{ won_bets }} ({{ win_rate|floatformat:1 }}%)</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Проиграно ставок:</span>
                    <span class="stat-value">{{ lost_bets }}</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Всего поставлено:</span>
                    <span class="stat-value">{{ total_wagered }} ₽</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Всего выиграно:</span>
                    <span class="stat-value">{{ total_won }} ₽</span>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <h2 class="card-title">Ставки по типам</h2>
            </div>
            <div class="stats-list">
                {% for bet_type in bet_types %}
                <div class="stat-item">
                    <span class="stat-label">{{ bet_type.bet_type }}:</span>
                    <span class="stat-value">{{ bet_type.count }} ({{ bet_type.won }} выиграно)</span>
                </div>
                {% empty %}
                <p>Нет данных по типам ставок</p>
                {% endfor %}
            </div>
        </div>
    </div>

    <div class="action-buttons">
        <a href="{% url 'betting:place_bet' %}" class="btn btn-primary">Сделать ставку</a>
        <a href="{% url 'betting:bet_history' %}" class="btn btn-secondary">История ставок</a>
    </div>
</div>
{% endblock %}